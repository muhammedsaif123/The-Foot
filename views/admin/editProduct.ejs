<%- include('../layouts/header.ejs')%>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/sweetalert2@11.0.18/dist/sweetalert2.min.css">
 <script src="cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.js"></script>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.4/jquery.min.js"></script>
    <!-- Add the following JavaScript scripts -->
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11.0.18/dist/sweetalert2.min.js"></script>

<div class="content-wrapper">
    <!-- Content -->

    <div class="container-xxl flex-grow-1 container-p-y">
      <h4 class="fw-bold py-3 mb-4"><span class="text-muted fw-light">Edit Product</span></h4>

      <!-- Basic Layout & Basic with Icons -->
      <div class="row">
        <!-- Basic Layout -->
        <div class="col-xxl">
          <div class="card mb-4">
            <div class="card-body">
              <form method="post" enctype="multipart/form-data">
                <div class="row mb-3">
                  <label class="col-sm-2 col-form-label"  for="basic-default-name">Product Name</label>
                  <div class="col-sm-10">
                    <input type="text" name="product" class="form-control" id="basic-default-name" value="<%=product.productName%>" />
                  </div>
                </div>

                <div style="display: flex;">
                  <%
                  for(let i=0;i<product.image.length;i++){
                    %>
                    <div>
                      <img style="width: 110px; height: 100px;margin: 20px;" src="/product/<%=product.image[i]%>"  alt="">
                      <button  class="btn btn-danger py-2 px-3" style="margin-bottom: 2px;padding: 5px 20px;margin: 0px 20px;" onclick="remove('<%=product._id%>','<%=i%>')">Remove</button>
                      <!-- <button type="button" style="background-color: red;color: white;border-radius: 15px;padding: 5px 20px;margin: 0px 20px;" onclick="remove('<%=product._id%>','<%=i%>')" >Remove</button> -->
                    </div>
                    <%
                  }
                  %>
                 </div>
                 <br>
                <div class="row mb-3">
                    <label class="col-sm-2 col-form-label"  for="basic-default-name">image</label>
                    <div class="col-sm-10">
                        
                        <input class="bt"  style="height: 28px;width: 228px ; background-color: gray;color: white;" accept="Image/*" type="file" name="Image"  multiple>                    
                      </div>
                </div>

                  <div class="row mb-3">
                    <label class="col-sm-2 col-form-label"  for="basic-default-name">Price</label>
                    <div class="col-sm-3">
                      <input type="text"  name="price" class="form-control" id="basic-default-name" value="<%=product.price%>" />
                    </div>
                    <label class="col-sm-2 col-form-label"  for="basic-default-name">Stock</label>
                  <div class="col-sm-3">
                    <input type="text"  name="stockQuantity" class="form-control" id="basic-default-name" value="<%=product.stockQuantity%>" />
                  </div>
                </div>

                <div class="row mb-3">
                  
              </div>

                <div class="row mb-3">
                  
                  <label class="col-sm-2 col-form-label"  for="basic-default-name">Category</label>
                  <div class="col-sm-3">
                    <select
                      class="col-md-12 form-control" name="category"
                    >
                      <%
                      if(cat.length>0){
                        for(let i=0;i<cat.length;i++){
                          %>
                          <option><%=cat[i].categoryName%></option>
                          <%
                        }
                      }
                      %>
                    </select>
                    </div>
                </div>
            
                <div class="row mb-3">
                    <label class="col-sm-2 col-form-label"  for="basic-default-name">description</label>
                    <div class="col-sm-10">
                      <input type="text" name="description" class="form-control" id="basic-default-name" value="<%=product.description%>" />
                    </div>
                </div>
                <div class="row justify-content-end">
                  <div class="col-sm-10">
                    <input type="submit" value="Save" class="btn btn-primary">
                    <%
                      if(typeof message !== 'undefined'){
                          %>
                          <h5 style="display: flex;width: 100%;justify-content: space-around;margin-top: 50px;font-family: Georgia, 'Times New Roman', Times, serif;color: red;"><%= message%></h5>
                          <%
                      }
                      %>
                  </div>
                </div>
              </form>
            </div>
          </div>
        </div>
      <script>
        function remove(id,pos){
          console.log(id,pos);
          $.ajax({
            url:"/admin/removeImage",
            data:{
              id:id,
              pos:pos
            },
            method:"post",
            success:(response)=>{
              if(response.success){
                location.reload()
              }
            }
          })
        }
      </script>